# VulnerabilityStandard

Для спецификации использована [json-schema](https://json-schema.org/). Проверить корректность `json` по ней можно например здесь - [validator](https://www.jsonschemavalidator.net/), так же есть поддержка из разных языков.

Хранится множество `json`, по одному на каждую функцию. Их формат - [vulnerability_standard](utils/vulnerability_standard.json). В нём есть обязательные `fully-qualified` класса и имя функции `function`. Так же необходимо описание уязвимости `description`.

Там же указывается то, по чему будут получаться ограничения на запуск. 

Пока есть следующие способы (ровно один должен быть указан в файле, описанном выше):
- functions - список путей до `json`, каждый из которых имеет вид [functions](utils/vulnerability_functions_standard.json)
- arguments - список путей до `json`, каждый из которых имеет вид [arguments](utils/vulnerability_argumetns_standard.json)
- constraints - список путей до `json`, каждый из которых имеет вид [constraints](utils/vulnerability_constraints_standard.json)

#### [functions](utils/vulnerability_functions_standard.json) - список объектов, идентифицирующих функцию, возвращающую bool (какое-то условие на аргументы. Если возвращается true, то найдена уязвимость)

Пример [functions](utils/vulnerability_functions_standard.json):

```json
[
  {
    "fullyQualified": "org.cyber.base.Example",
    "function": "fun1"
  }
]
```

#### [arguments](utils/vulnerability_argumetns_standard.json) - список разных наборов аргументов функции. Каждый набор имеет вид списка аргументов функции (простых типов)

Пример [arguments](utils/vulnerability_argumetns_standard.json):

```json
[
  ["../{FILE}"],
  ["../../{FILE}"]
]
```

#### [constraints](utils/vulnerability_constraints_standard.json) - список разных ограничений. Каждое ограничение имеет формат `constraint_format` (определённый в том же файле, пока находится в разработке)

Пример [constraints](utils/vulnerability_constraints_standard.json):

```json
[
  {
    "Ge": ["$0", 33]
  }
]
```

[//]: # (TODO create constraint_format)

`"$0"` - первый аргумент функции, `"Ge"` - >=. После функции идёт массив её аргументов.

#### Пути тоже имеют определённое значение. Если папка, в которой лежит файл, называется `windows/unix`, то всё что лежит в ней, используется только для указанной ос. Если папка называется иначе - используется для всех ос.
